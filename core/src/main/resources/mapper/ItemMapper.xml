<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.triplan.mapper.ItemMapper">

    <insert id="insert" useGeneratedKeys="true" keyProperty="itemId">
        INSERT INTO item (
            name,
            explain,
            item_category,
            base_stock,
            sales_volume,
            detail_img,
            item_group_id
        ) VALUES (
            #{name},
            #{explain},
            #{itemCategory},
            #{baseStock},
            #{salesVolume},
            #{detailImg},
            #{itemGroupId}
        )
    </insert>

    <select id="select" resultType="ItemVO">
        SELECT  *
        FROM    item
        WHERE   item_id = #{itemId}
    </select>

    <update id="update">
        UPDATE  item
        SET
                name            = IFNULL(     #{name},            name            ),
                explain         = IFNULL(     #{explain},         explain         ),
                item_category   = IFNULL(     #{itemCategory},    item_category   ),
                base_stock      = IFNULL(     #{baseStock},       base_stock      ),
                sales_volume    = IFNULL(     #{salesVolume},     sales_volume    ),
                detail_img      = IFNULL(     #{detailImg},       detail_img      ),
                item_group_id   = IFNULL(     #{itemGroupId},     item_group_id   ),
                updated_at       = CURRENT_TIMESTAMP <!-- BaseVO를 상속 받은 테이블에 들어가는 공통 구문 -->
        WHERE
                item_id         = #{itemId}
    </update>

    <delete id="delete">
        DELETE
        FROM    item
        WHERE   item_id = #{itemId}
    </delete>

    <select id="getItemByItemId" parameterType="map" resultType="ItemVO">
        SELECT *
          FROM item
         WHERE item_id = #{itemId} AND item_category = #{room}
    </select>



    <select id="getItemByItemGroupId" resultType="ItemVO">
        SELECT *
        FROM item
        WHERE item_group_id = #{itemGroupId}
    </select>

    <select id="getItemId" resultType="Integer">
        SELECT MAX(item_id) as item_id
          FROM item
    </select>

</mapper>